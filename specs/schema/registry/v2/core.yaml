version: 2
id: schema.registry.v2.core
type: core
fields:
  spec_version:
    type: int
    required: true
    since: v2
  schema_ref:
    type: string
    required: true
    since: v2
  defaults:
    type: mapping
    required: false
    since: v2
  harness:
    type: mapping
    required: true
    since: v2
  harness.type:
    type: string
    required: true
    since: v2
  harness.profile:
    type: string
    required: true
    since: v2
  harness.config:
    type: mapping
    required: false
    since: v2
  harness.docs:
    type: list
    required: false
    since: v2
  harness.docs[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for documentation entry. Not reference identity.
  harness.docs[].summary:
    type: string
    required: true
    since: v2
  harness.docs[].audience:
    type: string
    required: true
    since: v2
  harness.docs[].status:
    type: string
    required: true
    since: v2
    enum: &id001
    - draft
    - active
    - deprecated
    - retired
  harness.docs[].description:
    type: string
    required: false
    since: v2
  harness.docs[].type:
    type: string
    required: false
    since: v2
    enum: &id002
    - overview
    - reference
    - howto
    - policy
    - contract
    - changelog
  harness.docs[].since:
    type: string
    required: false
    since: v2
  harness.docs[].updated_at:
    type: string
    required: false
    since: v2
  harness.docs[].tags:
    type: list
    required: false
    since: v2
  harness.docs[].owners:
    type: list
    required: false
    since: v2
  harness.docs[].owners[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for docs owner entry. Not reference identity.
  harness.docs[].owners[].role:
    type: string
    required: true
    since: v2
    enum: &id003
    - owner
    - reviewer
    - approver
  harness.docs[].links:
    type: list
    required: false
    since: v2
  harness.docs[].links[].rel:
    type: string
    required: true
    since: v2
    enum: &id004
    - see_also
    - depends_on
    - implements
    - supersedes
    - replaced_by
  harness.docs[].links[].ref:
    type: string
    required: true
    since: v2
  harness.docs[].links[].title:
    type: string
    required: false
    since: v2
  harness.docs[].examples:
    type: list
    required: false
    since: v2
  harness.docs[].examples[].title:
    type: string
    required: true
    since: v2
  harness.docs[].examples[].ref:
    type: string
    required: true
    since: v2
  services:
    type: mapping
    required: false
    since: v2
  services.defaults:
    type: mapping
    required: false
    since: v2
  services.defaults.type:
    type: string
    required: false
    since: v2
  services.defaults.io:
    type: string
    required: false
    since: v2
    enum:
    - input
    - output
    - io
    description: Defaults to io when omitted.
  services.defaults.profile:
    type: string
    required: false
    since: v2
  services.defaults.config:
    type: mapping
    required: false
    since: v2
  services.actions:
    type: list
    required: true
    since: v2
  services.actions[].id:
    type: string
    required: true
    since: v2
  services.actions[].type:
    type: string
    required: false
    since: v2
    description: Integration service type from service catalog (`io.fs`, `io.http`,
      `io.system`, `io.mysql`, `io.docs`). Legacy orchestration types (`assert.check`,
      `assert.export`, `ops.job`) are invalid in v2.
  services.actions[].io:
    type: string
    required: false
    since: v2
    enum:
    - input
    - output
    - io
  services.actions[].profile:
    type: string
    required: false
    since: v2
    description: Service mode token for resolved service type (for example `read.text`,
      `request.http`, `exec.command`, `generate.docs`).
  services.actions[].config:
    type: mapping
    required: false
    since: v2
    description: Service runtime configuration mapping. External locators must be
      declared in `artifacts[]` and referenced by artifact id fields;
      direct locator keys (`path`, `url`, `token_url`, `template_path`,
      `output_path`, `ref`) are invalid.
  services.actions[].config.source_artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for `read.text` source payloads; must resolve to
      `artifacts[].id` where `io` is `input` or `io`.
  services.actions[].config.request.artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for `request.http` single request url; must resolve to
      `artifacts[].id` where `io` is `input` or `io`.
  services.actions[].config.requests[].artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for `request.http` scenario request url; must resolve to
      `artifacts[].id` where `io` is `input` or `io`.
  services.actions[].config.api_http.auth.oauth.token_artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for oauth token endpoint locator; must resolve to
      `artifacts[].id` where `io` is `input` or `io`.
  services.actions[].config.use[].artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for config.use dependency locator; must resolve to
      `artifacts[].id` where `io` is `input` or `io`.
  services.actions[].config.docs_generate.template_artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for docs template input; must resolve to
      `artifacts[].id` where `io` is `input` or `io`.
  services.actions[].config.docs_generate.output_artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for docs output target.
  services.actions[].config.docs_generate.data_sources[].artifact_id:
    type: string
    required: false
    since: v2
    description: Artifact id for docs data source payload; must resolve to
      `artifacts[].id` where `io` is `input` or `io`.
  services.actions[].imports:
    type: list
    required: false
    since: v2
    description: Service import declarations. Accepts either canonical list[mapping]
      rows (`names`, optional `as`) or compact list[string] alias.
      `imports: [a, b]` normalizes to canonical `{names:[a,b]}`; compact rows
      do not support aliasing. Mixed list item kinds in one `imports` list are
      invalid. Alias grammar and normalization are defined in
      `/specs/schema/registry/v2/aliases.yaml`.
  services.actions[].imports[].names:
    type: list
    required: true
    since: v2
    description: Declared service import names; each name must be unique per
      service entry after alias resolution and available for resolved
      type+profile in service catalog.
  services.actions[].imports[].as:
    type: mapping
    required: false
    since: v2
  services.actions[].docs:
    type: list
    required: false
    since: v2
  services.actions[].docs[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for documentation entry. Not reference identity.
  services.actions[].docs[].summary:
    type: string
    required: true
    since: v2
  services.actions[].docs[].audience:
    type: string
    required: true
    since: v2
  services.actions[].docs[].status:
    type: string
    required: true
    since: v2
    enum:
    - draft
    - active
    - deprecated
    - retired
  services.actions[].docs[].description:
    type: string
    required: false
    since: v2
  services.actions[].docs[].type:
    type: string
    required: false
    since: v2
    enum:
    - overview
    - reference
    - howto
    - policy
    - contract
    - changelog
  services.actions[].docs[].since:
    type: string
    required: false
    since: v2
  services.actions[].docs[].updated_at:
    type: string
    required: false
    since: v2
  services.actions[].docs[].tags:
    type: list
    required: false
    since: v2
  services.actions[].docs[].owners:
    type: list
    required: false
    since: v2
  services.actions[].docs[].owners[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for docs owner entry. Not reference identity.
  services.actions[].docs[].owners[].role:
    type: string
    required: true
    since: v2
    enum:
    - owner
    - reviewer
    - approver
  services.actions[].docs[].links:
    type: list
    required: false
    since: v2
  services.actions[].docs[].links[].rel:
    type: string
    required: true
    since: v2
    enum:
    - see_also
    - depends_on
    - implements
    - supersedes
    - replaced_by
  services.actions[].docs[].links[].ref:
    type: string
    required: true
    since: v2
  services.actions[].docs[].links[].title:
    type: string
    required: false
    since: v2
  services.actions[].docs[].examples:
    type: list
    required: false
    since: v2
  services.actions[].docs[].examples[].title:
    type: string
    required: true
    since: v2
  services.actions[].docs[].examples[].ref:
    type: string
    required: true
    since: v2
  artifacts:
    type: list
    required: false
    since: v2
  artifacts[].id:
    type: string
    required: true
    since: v2
  artifacts[].ref:
    type: string
    required: true
    since: v2
    description: Supports moustache templates resolved from suite context.
  artifacts[].io:
    type: string
    required: true
    since: v2
    enum:
    - input
    - output
    - io
  artifacts[].type:
    type: string
    required: false
    since: v2
  artifacts[].inputs:
    type: mapping
    required: false
    since: v2
  artifacts[].outputs:
    type: mapping
    required: false
    since: v2
  artifacts[].options:
    type: mapping
    required: false
    since: v2
  artifacts[].docs:
    type: list
    required: false
    since: v2
  artifacts[].docs[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for documentation entry. Not reference identity.
  artifacts[].docs[].summary:
    type: string
    required: true
    since: v2
  artifacts[].docs[].audience:
    type: string
    required: true
    since: v2
  artifacts[].docs[].status:
    type: string
    required: true
    since: v2
    enum:
    - draft
    - active
    - deprecated
    - retired
  artifacts[].docs[].description:
    type: string
    required: false
    since: v2
  artifacts[].docs[].type:
    type: string
    required: false
    since: v2
    enum:
    - overview
    - reference
    - howto
    - policy
    - contract
    - changelog
  artifacts[].docs[].since:
    type: string
    required: false
    since: v2
  artifacts[].docs[].updated_at:
    type: string
    required: false
    since: v2
  artifacts[].docs[].tags:
    type: list
    required: false
    since: v2
  artifacts[].docs[].owners:
    type: list
    required: false
    since: v2
  artifacts[].docs[].owners[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for docs owner entry. Not reference identity.
  artifacts[].docs[].owners[].role:
    type: string
    required: true
    since: v2
    enum:
    - owner
    - reviewer
    - approver
  artifacts[].docs[].links:
    type: list
    required: false
    since: v2
  artifacts[].docs[].links[].rel:
    type: string
    required: true
    since: v2
    enum:
    - see_also
    - depends_on
    - implements
    - supersedes
    - replaced_by
  artifacts[].docs[].links[].ref:
    type: string
    required: true
    since: v2
  artifacts[].docs[].links[].title:
    type: string
    required: false
    since: v2
  artifacts[].docs[].examples:
    type: list
    required: false
    since: v2
  artifacts[].docs[].examples[].title:
    type: string
    required: true
    since: v2
  artifacts[].docs[].examples[].ref:
    type: string
    required: true
    since: v2
  exports:
    type: list
    required: false
    since: v2
  exports[].as:
    type: string
    required: true
    since: v2
    description: Required function export symbol name.
  exports[].from:
    type: string
    required: true
    since: v2
    enum:
    - assert.function
    description: Required function export source.
  exports[].path:
    type: string
    required: true
    since: v2
    description: Required function export path.
  exports[].params:
    type: list
    required: false
    since: v2
    description: Optional ordered function parameter names.
  exports[].required:
    type: bool
    required: false
    since: v2
    description: Optional function export requirement flag.
  exports[].docs:
    type: list
    required: false
    since: v2
  exports[].docs[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for documentation entry. Not reference identity.
  exports[].docs[].summary:
    type: string
    required: true
    since: v2
  exports[].docs[].audience:
    type: string
    required: true
    since: v2
  exports[].docs[].status:
    type: string
    required: true
    since: v2
    enum:
    - draft
    - active
    - deprecated
    - retired
  exports[].docs[].description:
    type: string
    required: false
    since: v2
  exports[].docs[].type:
    type: string
    required: false
    since: v2
    enum:
    - overview
    - reference
    - howto
    - policy
    - contract
    - changelog
  exports[].docs[].since:
    type: string
    required: false
    since: v2
  exports[].docs[].updated_at:
    type: string
    required: false
    since: v2
  exports[].docs[].tags:
    type: list
    required: false
    since: v2
  exports[].docs[].owners:
    type: list
    required: false
    since: v2
  exports[].docs[].owners[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for docs owner entry. Not reference identity.
  exports[].docs[].owners[].role:
    type: string
    required: true
    since: v2
    enum:
    - owner
    - reviewer
    - approver
  exports[].docs[].links:
    type: list
    required: false
    since: v2
  exports[].docs[].links[].rel:
    type: string
    required: true
    since: v2
    enum:
    - see_also
    - depends_on
    - implements
    - supersedes
    - replaced_by
  exports[].docs[].links[].ref:
    type: string
    required: true
    since: v2
  exports[].docs[].links[].title:
    type: string
    required: false
    since: v2
  exports[].docs[].examples:
    type: list
    required: false
    since: v2
  exports[].docs[].examples[].title:
    type: string
    required: true
    since: v2
  exports[].docs[].examples[].ref:
    type: string
    required: true
    since: v2
  contracts:
    type: list
    required: true
    since: v2
  contracts[].id:
    type: string
    required: true
    since: v2
  title:
    type: string
    required: false
    since: v2
  purpose:
    type: string
    required: false
    since: v2
  docs:
    type: list
    required: false
    since: v2
  docs[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for documentation entry. Not reference identity.
  docs[].summary:
    type: string
    required: true
    since: v2
  docs[].audience:
    type: string
    required: true
    since: v2
  docs[].status:
    type: string
    required: true
    since: v2
    enum: *id001
  docs[].description:
    type: string
    required: false
    since: v2
  docs[].type:
    type: string
    required: false
    since: v2
    enum: *id002
  docs[].since:
    type: string
    required: false
    since: v2
  docs[].updated_at:
    type: string
    required: false
    since: v2
  docs[].tags:
    type: list
    required: false
    since: v2
  docs[].owners:
    type: list
    required: false
    since: v2
  docs[].owners[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for docs owner entry. Not reference identity.
  docs[].owners[].role:
    type: string
    required: true
    since: v2
    enum: *id003
  docs[].links:
    type: list
    required: false
    since: v2
  docs[].links[].rel:
    type: string
    required: true
    since: v2
    enum: *id004
  docs[].links[].ref:
    type: string
    required: true
    since: v2
  docs[].links[].title:
    type: string
    required: false
    since: v2
  docs[].examples:
    type: list
    required: false
    since: v2
  docs[].examples[].title:
    type: string
    required: true
    since: v2
  docs[].examples[].ref:
    type: string
    required: true
    since: v2
  domain:
    type: string
    required: false
    since: v2
  contracts[].title:
    type: string
    required: false
    since: v2
  contracts[].purpose:
    type: string
    required: false
    since: v2
  contracts[].domain:
    type: string
    required: false
    since: v2
  contracts[].docs:
    type: list
    required: false
    since: v2
  contracts[].docs[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for documentation entry. Not reference identity.
  contracts[].docs[].summary:
    type: string
    required: true
    since: v2
  contracts[].docs[].audience:
    type: string
    required: true
    since: v2
  contracts[].docs[].status:
    type: string
    required: true
    since: v2
    enum:
    - draft
    - active
    - deprecated
    - retired
  contracts[].docs[].description:
    type: string
    required: false
    since: v2
  contracts[].docs[].type:
    type: string
    required: false
    since: v2
    enum:
    - overview
    - reference
    - howto
    - policy
    - contract
    - changelog
  contracts[].docs[].since:
    type: string
    required: false
    since: v2
  contracts[].docs[].updated_at:
    type: string
    required: false
    since: v2
  contracts[].docs[].tags:
    type: list
    required: false
    since: v2
  contracts[].docs[].owners:
    type: list
    required: false
    since: v2
  contracts[].docs[].owners[].id:
    type: string
    required: false
    since: v2
    description: Optional metadata id for docs owner entry. Not reference identity.
  contracts[].docs[].owners[].role:
    type: string
    required: true
    since: v2
    enum:
    - owner
    - reviewer
    - approver
  contracts[].docs[].links:
    type: list
    required: false
    since: v2
  contracts[].docs[].links[].rel:
    type: string
    required: true
    since: v2
    enum:
    - see_also
    - depends_on
    - implements
    - supersedes
    - replaced_by
  contracts[].docs[].links[].ref:
    type: string
    required: true
    since: v2
  contracts[].docs[].links[].title:
    type: string
    required: false
    since: v2
  contracts[].docs[].examples:
    type: list
    required: false
    since: v2
  contracts[].docs[].examples[].title:
    type: string
    required: true
    since: v2
  contracts[].docs[].examples[].ref:
    type: string
    required: true
    since: v2
  contracts[].when:
    type: mapping
    required: false
    since: v2
  contracts[].when.required:
    type: list
    required: false
    since: v2
  contracts[].when.optional:
    type: list
    required: false
    since: v2
  contracts[].when.fail:
    type: list
    required: false
    since: v2
  contracts[].when.complete:
    type: list
    required: false
    since: v2
  contracts[].bindings:
    type: any
    required: false
    since: v2
    description: Supports either canonical list form (`contracts[].bindings[]`)
      or additive mapping form (`contracts[].bindings.defaults` +
      `contracts[].bindings.rows[]`), normalized to effective binding rows before
      validation. Alias/shape grammar and effective-row normalization are
      defined in `/specs/schema/registry/v2/aliases.yaml`.
  contracts[].bindings.defaults:
    type: mapping
    required: false
    since: v2
  contracts[].bindings.defaults.service:
    type: string
    required: false
    since: v2
    description: Optional default binding service id.
  contracts[].bindings.defaults.import:
    type: string
    required: false
    since: v2
    description: Optional default binding import name.
  contracts[].bindings.defaults.mode:
    type: string
    required: false
    since: v2
    enum:
    - merge
    - override
  contracts[].bindings.defaults.predicates:
    type: list
    required: false
    since: v2
  contracts[].bindings.rows:
    type: list
    required: false
    since: v2
    description: Binding rows when using mapping-form contract bindings.
  contracts[].bindings.rows[].id:
    type: string
    required: true
    since: v2
  contracts[].bindings.rows[].service:
    type: string
    required: false
    since: v2
  contracts[].bindings.rows[].import:
    type: string
    required: false
    since: v2
  contracts[].bindings.rows[].inputs:
    type: list
    required: false
    since: v2
  contracts[].bindings.rows[].inputs[].from:
    type: string
    required: true
    since: v2
  contracts[].bindings.rows[].inputs[].as:
    type: string
    required: true
    since: v2
  contracts[].bindings.rows[].outputs:
    type: list
    required: false
    since: v2
  contracts[].bindings.rows[].outputs[].to:
    type: string
    required: true
    since: v2
  contracts[].bindings.rows[].outputs[].as:
    type: string
    required: false
    since: v2
  contracts[].bindings.rows[].outputs[].path:
    type: string
    required: false
    since: v2
  contracts[].bindings.rows[].predicates:
    type: list
    required: false
    since: v2
  contracts[].bindings.rows[].mode:
    type: string
    required: false
    since: v2
    enum:
    - merge
    - override
  contracts[].bindings[].id:
    type: string
    required: true
    since: v2
  contracts[].bindings[].service:
    type: string
    required: false
    since: v2
    description: Optional when inherited from `contracts[].bindings.defaults.service`;
      effective binding service is required after defaults merge.
  contracts[].bindings[].import:
    type: string
    required: false
    since: v2
    description: Optional when inherited from `contracts[].bindings.defaults.import`;
      effective binding import is required after defaults merge.
  contracts[].bindings[].inputs:
    type: list
    required: false
    since: v2
  contracts[].bindings[].inputs[].from:
    type: string
    required: true
    since: v2
  contracts[].bindings[].inputs[].as:
    type: string
    required: true
    since: v2
  contracts[].bindings[].outputs:
    type: list
    required: false
    since: v2
  contracts[].bindings[].outputs[].to:
    type: string
    required: true
    since: v2
  contracts[].bindings[].outputs[].as:
    type: string
    required: false
    since: v2
  contracts[].bindings[].outputs[].path:
    type: string
    required: false
    since: v2
  contracts[].bindings[].predicates:
    type: list
    required: false
    since: v2
  contracts[].bindings[].mode:
    type: string
    required: false
    since: v2
    enum:
    - merge
    - override
  contracts[].clauses:
    type: mapping
    required: true
    since: v2
  contracts[].expect:
    type: mapping
    required: false
    since: v2
  contracts[].expect.portable:
    type: mapping
    required: false
    since: v2
  contracts[].expect.portable.status:
    type: string
    required: false
    since: v2
  contracts[].expect.portable.category:
    type: string
    required: false
    since: v2
  contracts[].expect.portable.message_tokens:
    type: list
    required: false
    since: v2
  contracts[].expect.overrides:
    type: list
    required: false
    since: v2
  contracts[].expect.overrides[].runner:
    type: string
    required: true
    since: v2
  contracts[].expect.overrides[].status:
    type: string
    required: false
    since: v2
  contracts[].expect.overrides[].category:
    type: string
    required: false
    since: v2
  contracts[].expect.overrides[].message_tokens:
    type: list
    required: false
    since: v2
  contracts[].requires:
    type: mapping
    required: false
    since: v2
    description: Source artifact id; must resolve to `artifacts[].id` where
      `io` is `input` or `io`.
    description: Output artifact id; must resolve to `artifacts[].id` where
      `io` is `output` or `io`.
