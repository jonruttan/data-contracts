version: 2
id: schema.registry.v2.assertions
type: assertions
fields:
  contracts[].clauses:
    type: mapping
    required: true
    since: v2
    description: Canonical clause tree root mapping with defaults/predicates; 
      leaves are direct spec-lang operator mappings. Binding-piped symbols are 
      merged into effective predicate import context after clause/predicate 
      import merge.
  contracts[].clauses.defaults:
    type: mapping
    required: false
    since: v2
    description: Optional clause-level defaults mapping.
  contracts[].clauses.imports:
    type: list
    required: false
    since: v2
    description: Clause-level default import bindings inherited by predicates.
      For from=artifact, every imported name must be explicitly declared at suite
      root (`artifacts[].id`) and wired through
      `contracts[].bindings` when runtime-produced. Supports canonical rows (`from`, `names`,
      optional `service`, optional `as`) and grouped compact alias rows.
      Bare string rows (for example `- pipe_identity`) are compact service
      aliases normalized to `{from: service, names:[pipe_identity], service:<resolved>}`,
      where `<resolved>` is `contracts[].bindings.defaults.service` for the same
      contract. Alias grammar and normalization are defined in
      `/specs/schema/registry/v2/aliases.yaml`.
  contracts[].clauses.imports[].artifact:
    type: list
    required: false
    since: v2
    description: Compact artifact import alias row (`artifact: [id_a, id_b]`)
      normalized to canonical `{from: artifact, names: [...]}`.
  contracts[].clauses.imports[].service.id:
    type: string
    required: false
    since: v2
    description: Compact service import alias service id (`service: {id: ...,
      names: [...]}`).
  contracts[].clauses.imports[].service.names:
    type: list
    required: false
    since: v2
    description: Compact service import alias names.
  contracts[].clauses.imports[].service.as:
    type: mapping
    required: false
    since: v2
    description: Compact service import alias map.
  contracts[].clauses.imports[].from:
    type: string
    required: true
    since: v2
    description: 'Import source: artifact or service.'
  contracts[].clauses.imports[].service:
    type: string
    required: false
    since: v2
    description: Required when from=service; references services.actions[].id.
  contracts[].clauses.imports[].names:
    type: list
    required: true
    since: v2
    description: Imported symbol names; from=artifact names must resolve to
      suite-declared artifact ids.
  contracts[].clauses.imports[].as:
    type: mapping
    required: false
    since: v2
    description: Optional local alias map.
  contracts[].clauses.predicates:
    type: list
    required: true
    since: v2
    description: Non-empty predicate list.
  contracts[].clauses.predicates[].id:
    type: string
    required: true
    since: v2
    description: Stable predicate id.
  contracts[].clauses.predicates[].imports:
    type: list
    required: false
    since: v2
    description: Predicate-level imports merged over clauses.imports. from=artifact
      names must resolve to suite-declared artifact ids. Supports canonical
      rows and grouped compact alias rows.
      Bare string rows (for example `- pipe_identity`) are compact service
      aliases normalized to `{from: service, names:[pipe_identity], service:<resolved>}`,
      where `<resolved>` is `contracts[].bindings.defaults.service` for the same
      contract. Alias grammar and normalization are defined in
      `/specs/schema/registry/v2/aliases.yaml`.
  contracts[].clauses.predicates[].imports[].artifact:
    type: list
    required: false
    since: v2
    description: Compact artifact import alias row (`artifact: [id_a, id_b]`)
      normalized to canonical `{from: artifact, names: [...]}`.
  contracts[].clauses.predicates[].imports[].service.id:
    type: string
    required: false
    since: v2
    description: Compact service import alias service id.
  contracts[].clauses.predicates[].imports[].service.names:
    type: list
    required: false
    since: v2
    description: Compact service import alias names.
  contracts[].clauses.predicates[].imports[].service.as:
    type: mapping
    required: false
    since: v2
    description: Compact service import alias map.
  contracts[].clauses.predicates[].imports[].from:
    type: string
    required: true
    since: v2
    description: 'Import source: artifact or service.'
  contracts[].clauses.predicates[].imports[].service:
    type: string
    required: false
    since: v2
    description: Required when from=service; references services.actions[].id.
  contracts[].clauses.predicates[].imports[].names:
    type: list
    required: true
    since: v2
    description: Imported symbol names; from=artifact names must resolve to
      suite-declared artifact ids.
  contracts[].clauses.predicates[].imports[].as:
    type: mapping
    required: false
    since: v2
    description: Optional local alias map.
  contracts[].clauses.predicates[].purpose:
    type: string
    required: false
    since: v2
    description: Optional human-readable predicate intent.
  contracts[].clauses.predicates[].required:
    type: bool
    required: false
    since: v2
    description: Optional requiredness flag; defaults to true when omitted.
  contracts[].clauses.predicates[].priority:
    type: int
    required: false
    since: v2
    description: Optional positive integer priority metadata (default 1).
  contracts[].clauses.predicates[].severity:
    type: int
    required: false
    since: v2
    description: Optional positive integer severity metadata (default 1).
  contracts[].clauses.predicates[].assert:
    type: any
    required: true
    since: v2
    description: Non-empty expression mapping or non-empty expression list.
