version: 1
profiles:
  critical:
    checks:
      - id: runtime.critical_check_set_manifest_required
        kind: manifest_non_empty
        path: /specs/governance/check_sets_v1.yaml
        profile: critical
        key: checks
      - id: runtime.critical_gate_rust_native_only_required
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - '"critical-gate" => run_critical_gate_native'
      - id: runtime.critical_gate_python_exec_forbidden
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/governance.rs
        must_not_contain:
          - run_cmd(
          - run_governance_specs.py
      - id: runtime.critical_gate_artifacts_required
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/governance.rs
        must_contain:
          - '{default_out_prefix}-summary.json'
          - '{default_out_prefix}-trace.json'
          - '{default_out_prefix}-summary.md'
      - id: runtime.critical_gate_invoked_first_in_ci_gate_sh
        kind: file_ordered_tokens
        path: /scripts/ci_gate.sh
        ordered_tokens:
          - critical-gate
          - ci-gate-summary
      - id: runtime.critical_ci_gate_ownership_contract_python
        kind: file_tokens
        path: /spec_runner/script_runtime_commands.py
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
      - id: runtime.critical_ci_gate_ownership_contract_rust
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
      - id: runtime.critical_governance_check_registered
        kind: file_tokens
        path: /spec_runner/governance_runtime.py
        must_contain:
          - runtime.ci_gate_ownership_contract_required
      - id: runtime.critical_governance_case_indexed
        kind: file_tokens
        path: /specs/governance/cases/core/index.md
        must_contain:
          - runtime_ci_gate_ownership_contract_required.spec.md
      - id: runtime.critical_gate_slo_sub_10s_required
        kind: slo_budget
        max_ms: 10000
  full:
    checks:
      - id: runtime.full_check_set_manifest_required
        kind: manifest_non_empty
        path: /specs/governance/check_sets_v1.yaml
        profile: full
        key: checks
      - id: runtime.full_ci_gate_step_order_python
        kind: file_tokens
        path: /spec_runner/script_runtime_commands.py
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
      - id: runtime.full_ci_gate_step_tokens_rust
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
      - id: runtime.full_ci_gate_broad_is_native_python
        kind: file_tokens
        path: /spec_runner/script_runtime_commands.py
        must_contain:
          - governance-broad-native
        must_not_contain:
          - '"governance"),'
      - id: runtime.full_ci_gate_broad_is_native_rust
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - governance-broad-native
          - '"governance-broad-native" => run_governance_broad_native'
      - id: runtime.full_ci_gate_no_python_governance_default
        kind: file_tokens
        path: /scripts/ci_gate.sh
        must_not_contain:
          - governance --check-prefix
          - run_governance_specs.py
      - id: runtime.full_governance_broad_native_slo
        kind: slo_budget
        max_ms: 120000
