version: 1
profiles:
  critical:
    checks:
      - id: runtime.critical_check_set_manifest_required
        kind: manifest_non_empty
        path: /specs/governance/check_sets_v1.yaml
        profile: critical
        key: checks
      - id: runtime.critical_gate_rust_native_only_required
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - '"critical-gate" => run_critical_gate_native'
      - id: runtime.critical_gate_python_exec_forbidden
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/governance.rs
        must_not_contain:
          - run_cmd(
          - run_governance_specs.py
      - id: runtime.critical_gate_artifacts_required
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/governance.rs
        must_contain:
          - '{default_out_prefix}-summary.json'
          - '{default_out_prefix}-trace.json'
          - '{default_out_prefix}-summary.md'
      - id: runtime.critical_gate_invoked_first_in_ci_gate_sh
        kind: file_ordered_tokens
        path: /scripts/ci_gate.sh
        ordered_tokens:
          - critical-gate
          - ci-gate-summary
      - id: runtime.critical_ci_gate_ownership_contract_python
        kind: file_tokens
        path: /runners/python/spec_runner/script_runtime_commands.py
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
      - id: runtime.critical_ci_gate_ownership_contract_rust
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
      - id: runtime.critical_governance_check_registered
        kind: file_tokens
        path: /runners/python/spec_runner/governance_runtime.py
        must_contain:
          - runtime.ci_gate_ownership_contract_required
      - id: runtime.critical_governance_case_indexed
        kind: file_tokens
        path: /specs/governance/cases/core/index.md
        must_contain:
          - runtime_ci_gate_ownership_contract_required.spec.md
      - id: runtime.critical_gate_slo_sub_10s_required
        kind: slo_budget
        max_ms: 10000
  full:
    checks:
      - id: runtime.full_check_set_manifest_required
        kind: manifest_non_empty
        path: /specs/governance/check_sets_v1.yaml
        profile: full
        key: checks
      - id: runtime.full_ci_gate_step_order_python
        kind: file_tokens
        path: /runners/python/spec_runner/script_runtime_commands.py
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
      - id: runtime.full_ci_gate_step_tokens_rust
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - governance_broad
        must_not_contain:
          - governance_critical
          - spec_runner.spec_lang_commands
          - PYTHONPATH
          - python3
      - id: runtime.full_ci_gate_broad_is_native_python
        kind: file_tokens
        path: /runners/python/spec_runner/script_runtime_commands.py
        must_contain:
          - governance-broad-native
        must_not_contain:
          - '"governance"),'
      - id: runtime.full_ci_gate_broad_is_native_rust
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - governance-broad-native
          - '"governance-broad-native" => run_governance_broad_native'
      - id: runtime.full_ci_gate_no_python_governance_default
        kind: file_tokens
        path: /scripts/ci_gate.sh
        must_not_contain:
          - governance --check-prefix
          - run_governance_specs.py
      - id: runtime.full_required_rust_lane_blocking_status
        kind: file_tokens
        path: /.github/workflows/ci.yml
        must_contain:
          - ci-gate:
          - Run CI gate (required rust lane)
      - id: runtime.full_compatibility_lanes_non_blocking_status
        kind: file_tokens
        path: /.github/workflows/ci.yml
        must_contain:
          - compatibility-python-lane:
          - compatibility-php-lane:
          - compatibility-node-lane:
          - compatibility-c-lane:
          - continue-on-error: true
      - id: runtime.full_compatibility_matrix_contract_registered
        kind: file_tokens
        path: /specs/contract/25_compatibility_matrix.md
        must_contain:
          - '`required`:'
          - '`compatibility_non_blocking`:'
          - '`rust`'
          - '`python`'
          - '`php`'
          - '`node`'
          - '`c`'
      - id: runtime.full_runner_certification_registry_registered
        kind: file_tokens
        path: /specs/schema/runner_certification_registry_v1.yaml
        must_contain:
          - runner_id: rust
          - runner_id: python
          - runner_id: php
          - runner_id: node
          - runner_id: c
      - id: runtime.full_runner_certification_subcommand_declared
        kind: file_tokens
        path: /runners/rust/spec_runner_cli/src/main.rs
        must_contain:
          - '"runner-certify" => run_runner_certify_native'
      - id: schema.full_contract_imports_explicit_required
        kind: file_tokens
        path: /runners/python/spec_runner/governance_runtime.py
        must_contain:
          - schema.contract_imports_explicit_required
          - schema.contract_target_on_forbidden
          - runtime.implicit_subject_binding_forbidden
      - id: docs.full_readme_rust_first_coherence_registered
        kind: file_tokens
        path: /runners/python/spec_runner/governance_runtime.py
        must_contain:
          - docs.readme_rust_first_coherence
      - id: docs.full_readme_rust_first_coherence_prefix_mapped
        kind: file_tokens
        path: /specs/governance/check_prefix_map_v1.yaml
        must_contain:
          - DCGOV-DOCS-REF-010
          - docs.readme_rust_first_coherence
      - id: docs.full_reviews_contract_checks_registered
        kind: file_tokens
        path: /runners/python/spec_runner/governance_runtime.py
        must_contain:
          - docs.reviews_prompt_schema_contract_sync
          - docs.review_snapshot_template_contract_sync
          - docs.review_tooling_contract_sync
          - docs.review_snapshots_schema_valid
          - docs.reviews_discovery_prompt_present
          - docs.reviews_discovery_prompt_contract_sync
          - docs.reviews_discovery_workflow_sync
      - id: docs.full_reviews_contract_checks_prefix_mapped
        kind: file_tokens
        path: /specs/governance/check_prefix_map_v1.yaml
        must_contain:
          - DCGOV-DOCS-REF-012
          - docs.reviews_prompt_schema_contract_sync
          - DCGOV-DOCS-REF-013
          - docs.review_snapshot_template_contract_sync
          - DCGOV-DOCS-REF-014
          - docs.review_tooling_contract_sync
          - DCGOV-DOCS-REF-015
          - docs.review_snapshots_schema_valid
          - DCGOV-DOCS-REF-016
          - docs.reviews_discovery_prompt_present
          - DCGOV-DOCS-REF-017
          - docs.reviews_discovery_prompt_contract_sync
          - DCGOV-DOCS-REF-018
          - docs.reviews_discovery_workflow_sync
      - id: runtime.full_governance_broad_native_slo
        kind: slo_budget
        max_ms: 120000
