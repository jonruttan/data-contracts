version: 1
title: Spec Runner Portable Contract Policy
rules:
  - id: CLI_RUN_ENTRYPOINT_REQUIRED
    scope: case
    applies_to: cli.run.harness.entrypoint
    norm: MUST
    requirement: present
    description: For cli.run, harness.entrypoint must be set in each case.
    rationale: Ensures portable, explicit invocation without hidden runner state.
    risk_if_violated: Cases become environment-dependent and non-portable.
    references:
      - docs/spec/contract/04-harness.md
      - docs/spec/schema/schema-v1.md

  - id: CLI_RUN_ENTRYPOINT_ENV_FALLBACK
    scope: implementation
    applies_to: cli.run.entrypoint_resolution
    norm: SHOULD
    requirement: support_env_fallback_when_feasible
    description: >
      Implementations should support environment fallback for local/CI
      ergonomics when runtime constraints allow.
    rationale: Improves ergonomics in local and containerized workflows.
    risk_if_violated: Higher setup friction in some environments.
    examples:
      - SPEC_RUNNER_ENTRYPOINT
    references:
      - docs/spec/contract/04-harness.md
      - docs/spec/impl/python.md

  - id: CLI_RUN_CONFORMANCE_EXPLICIT_ENTRYPOINT
    scope: conformance
    applies_to: fixtures.cli.run
    norm: MUST
    requirement: explicit_harness_entrypoint
    description: Portable conformance fixtures must set harness.entrypoint.
    rationale: Keeps parity checks independent of implementation conveniences.
    risk_if_violated: Conformance results can diverge across runtimes.
    references:
      - docs/spec/contract/04-harness.md
      - docs/spec/contract/06-conformance.md

  - id: CLI_RUN_CONFORMANCE_NO_ENV_DEPENDENCY
    scope: conformance
    applies_to: fixtures.cli.run
    norm: MUST_NOT
    requirement: rely_on_env_fallback
    description: Portable conformance fixtures must not depend on env fallback.
    rationale: Prevents ambient-environment coupling in parity tests.
    risk_if_violated: Flaky or non-reproducible cross-language conformance.
    references:
      - docs/spec/contract/04-harness.md
      - docs/spec/contract/06-conformance.md
